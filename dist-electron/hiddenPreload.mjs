"use strict";var h=Object.defineProperty;var m=(l,t,n)=>t in l?h(l,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[t]=n;var e=(l,t,n)=>m(l,typeof t!="symbol"?t+"":t,n);const o=require("electron"),c="#new_post",i="post",u="account",p=".pms-account-navigation";console.log("[Hidden Preload] Script loaded.");window.addEventListener("DOMContentLoaded",()=>{console.log("[Hidden Preload] DOM Content Loaded. Running URL-based checks.");const l=window.location.href;l.includes(i)?(console.log(`[Hidden Preload] Current URL includes '${i}'. Checking for element: ${c}`),document.querySelector(c)?(console.log(`[Hidden Preload] Element '${c}' found.`),o.ipcRenderer.send("loged-in"),new v):(console.log(`[Hidden Preload] Element '${c}' NOT found. Sending 'form-missing' notification.`),o.ipcRenderer.send("form-missing",c))):l.includes(u)?(console.log(`[Hidden Preload] Current URL includes '${u}'. Checking for account navigation.`),document.querySelector(p)?(console.log("[Hidden Preload] Account navigation element found. Sending 'login-success' notification."),o.ipcRenderer.send("login-success")):console.log("[Hidden Preload] Account navigation element NOT found.")):console.log("[Hidden Preload] Current URL does not match any specific check."),o.ipcRenderer.on("chapter-post",(t,n)=>{console.log("[Hidden Preload] Chapter post event received. Sending 'chapter-post' notification."),console.log(n)})});class v{constructor(){e(this,"selectedNovel");e(this,"selectedVolume");e(this,"chapterNumber");e(this,"chapterTitle");e(this,"scheduleDate");e(this,"sellWithGold");e(this,"chapterContent");e(this,"postOnOtherWebsite");e(this,"scheduleOtherDate");e(this,"novelSelectElement");e(this,"volumeSelectElement");e(this,"newVolumeCheckboxElement");e(this,"newVolumeInputElement");e(this,"chapterNumberInputElement");e(this,"chapterTitleInputElement");e(this,"scheduleDateInputElement");e(this,"scheduleDateCheckboxElement");e(this,"sellWithGoldCheckboxElement");e(this,"chapterContentTextareaElement");e(this,"postOnOtherWebsiteCheckboxElement");e(this,"scheduleOtherDateCheckboxElement");e(this,"scheduleOtherDateInputElement");this.selectedNovel="",this.selectedVolume="",this.chapterNumber="",this.chapterTitle="",this.scheduleDate=void 0,this.sellWithGold=!1,this.chapterContent="",this.postOnOtherWebsite=!1,this.scheduleOtherDate=void 0,this.novelSelectElement=document.querySelector("#cat"),this.volumeSelectElement=document.querySelector("#volume"),this.newVolumeCheckboxElement=document.querySelector("#volume-new"),this.newVolumeInputElement=document.querySelector("#ero_volume"),this.chapterNumberInputElement=document.querySelector("#ero_chapter"),this.chapterTitleInputElement=document.querySelector("#title"),this.scheduleDateCheckboxElement=document.querySelector("#featers"),this.scheduleDateInputElement={start:document.querySelector("#start"),minute:document.querySelector("#minute"),hour:document.querySelector("#hour")},this.sellWithGoldCheckboxElement=document.querySelector("#gold"),this.chapterContentTextareaElement=document.querySelector("#description"),this.postOnOtherWebsiteCheckboxElement=document.querySelector("#post_other"),this.scheduleOtherDateCheckboxElement=document.querySelector("#schedule_checkbox"),this.scheduleOtherDateInputElement={start:document.querySelector("#schedule_date"),minute:document.querySelector("#schedule_minute"),hour:document.querySelector("#schedule_hour")},o.ipcRenderer.send("console-log","Chapter page Manger created"),o.ipcRenderer.on("novel-selected",(t,n)=>{o.ipcRenderer.send("console-log","Novel selected:"+n),this.fetchVolumes(n)}),this.getAndSendNovles()}async fetchVolumes(t){console.log("Fetching volumes");const s=await(await fetch("https://kolnovel.com/wp-admin/admin-ajax.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"volume_search",cat:t})})).text(),r=document.createElement("div");r.innerHTML=s;const a=Array.from(r.querySelectorAll("option")).slice(1).map(d=>({value:d.value,label:d.text}));o.ipcRenderer.send("novels-volumes-hidden",a)}handleNovelChange(t){this.selectedNovel=t,this.selectedVolume=""}getAndSendNovles(){const t=this.novelSelectElement;if(!t)return;const n=Array.from(t.options).slice(1).map(s=>({value:s.value,label:s.text}));o.ipcRenderer.send("novels-data-hidden",n),o.ipcRenderer.send("console-log","Novels data sent")}}
